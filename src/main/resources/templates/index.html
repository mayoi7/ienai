<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta http-equiv="X-UA-Compatible" content="ie=edge" />
  <title>IENAI</title>
  <link rel="stylesheet" href="/css/bootstrap.min.css" />
  <link rel="stylesheet" href="/css/main.css" />
  <link rel="stylesheet" href="/css/index.css" />
</head>
<body>
<div id="app">
  <div class="header">
    <div class="info">
      <div id="userinf" style="display: none;">
        <div class="operate-items" style="display: inline-block;">
          <button type="button" class="item message" title="消息">
            <span class="message-pic unread" style="display: inline-flex; align-items: center;color: #8d8d8d">​
              <svg fill="currentColor" viewBox="0 0 24 24" width="22" height="22">
                <path d="M4.523 15.076l.804-6.757a6.753 6.753 0 0 1 4.945-5.7 1.823 1.823 0 0 1 3.623 0 6.753 6.753 0 0 1 4.945 5.7l.804 6.757a2.293 2.293 0 0 0 1.712 2.108 1.093 1.093 0 0 1-.297 2.15H3.108a1.093 1.093 0 0 1-.297-2.15 2.293 2.293 0 0 0 1.712-2.108zM12.083 23a2.758 2.758 0 0 1-2.753-2.509.229.229 0 0 1 .232-.24h5.043a.229.229 0 0 1 .232.24 2.759 2.759 0 0 1-2.753 2.51z"></path>
              </svg>
            </span>
          </button>
          <button type="button" class="item follwer" title="对你有兴趣的人" style="color: #e30000;">
            <span class="follwer-pic" style="display: inline-flex; align-items: center;">
            ​  <svg fill="currentColor" viewBox="0 0 24 24" style="width: 21px;">
                <path d="M2 8.437C2 5.505 4.294 3.094 7.207 3 9.243 3 11.092 4.19 12 6c.823-1.758 2.649-3 4.651-3C19.545 3 22 5.507 22 8.432 22 16.24 13.842 21 12 21 10.158 21 2 16.24 2 8.437z" fill-rule="evenodd"></path>
              </svg>
            </span>
            <span class="count follwer-count">365</span>
          </button>
          <button type="button" class="item lover" title="关注你的人" style="color: #d5b512;">
            <span class="lover-pic" style="display: inline-flex; align-items: center;">​
              <svg fill="currentColor" viewBox="0 0 24 24" style="width: 21px;">
                <path d="M5.515 19.64l.918-5.355-3.89-3.792c-.926-.902-.639-1.784.64-1.97L8.56 7.74l2.404-4.871c.572-1.16 1.5-1.16 2.072 0L15.44 7.74l5.377.782c1.28.186 1.566 1.068.64 1.97l-3.89 3.793.918 5.354c.219 1.274-.532 1.82-1.676 1.218L12 18.33l-4.808 2.528c-1.145.602-1.896.056-1.677-1.218z" fill-rule="evenodd"></path></svg></span>
            <span class="count lover-count">12</span>
          </button>
          <div class="item signature">
            <textarea class="signature-text" name="intro" :value="user.intro" type="text" disabled="true" maxlength="20"></textarea>
          </div>
          <button class="note-write div-btn">
            写留言
            <svg style="width: 21px; position: relative; top: 3px; left: 2px;" fill="currentColor" version="1.1" x="0px" y="0px" viewBox="0 0 1000 1000" enable-background="new 0 0 1000 1000" xml:space="preserve">
              <g><g transform="translate(0.000000,511.000000) scale(0.100000,-0.100000)">
                <path d="M9509.4,4594.2C6987.5,2833.5,5474.7,1635.9,4357.9,515.3C3318-526.5,2720.2-1443.4,2589.5-2198.9c-40.4-230.7-34.6-661.2,7.7-659.3c5.8,0,73.1,88.4,146.1,196.1C3131.5-2097,3935-1066.7,4488.6-422.7C5361.3,590.3,6345.5,1586,7222,2341.4c407.5,351.8,1182.2,970.7,1182.2,945.7c0-3.8-88.4-80.7-196.1-169.2C6745.3,1922.4,4949.9-61.4,3068.1-2560.2c-424.8-565.1-530.5-682.4-617-690.1c-42.3-1.9-55.7,105.7-26.9,213.4c19.2,69.2,19.2,69.2-15.4,32.7c-63.4-67.3-907.3-1107.2-1011.1-1245.6c-142.2-192.2-236.4-376.7-190.3-376.7c25,0,155.7,86.5,309.5,205.7c176.8,136.5,430.6,382.5,949.6,922.7c353.7,367.1,353.7,367.1,488.2,409.4c224.9,71.1,693.9,265.3,1018.8,422.9C5553.5-1904.8,6931.7-684.2,8065.8,963.2c82.6,119.2,144.2,223,138.4,228.8c-5.8,7.7-161.5-1.9-344.1-21.2c-397.9-40.4-1003.4-61.5-1068.7-36.5c-36.5,15.4,1.9,21.1,163.4,30.8c451.7,26.9,1255.2,201.8,1422.4,311.4c88.4,57.7,742,1243.7,690.1,1255.2c-15.4,3.8-134.6-11.5-263.4-34.6c-130.7-23.1-322.9-44.2-428.7-50l-192.2-7.7l221.1,46.1c290.2,63.4,701.6,198,761.2,249.9c51.9,46.1,255.7,509.4,436.3,993.8c138.4,369.1,307.6,891.9,297.9,916.9C9895.8,4855.6,9720.8,4742.2,9509.4,4594.2z"/><path d="M1169-1074.4c-17.3-25-30.8-82.6-30.8-136.5c0-73.1,9.6-101.9,48.1-140.3l46.1-46.1l684.3,3.8l684.3,5.8l94.2,178.8l94.2,176.8h-795.8h-795.8L1169-1074.4z"/><path d="M1078.6-1645.3c-30.8-30.7-55.7-73-55.7-94.2c0-28.8-23.1-40.4-121.1-57.7c-159.5-28.8-342.2-90.4-488.2-161.5C280.9-2023.9,129-2170,107.9-2252.7c-23.1-94.2,7.7-607.4,50-801.6c115.3-544,392.1-1066.8,717-1349.4l113.4-98l40.4,57.7c113.4,153.8,761.2,997.6,982.2,1278.3l249.9,317.2l25,249.9c13.5,136.5,38.4,317.2,55.7,401.7c26.9,130.7,128.8,474.8,171.1,574.7c13.5,30.7-26.9,32.7-682.4,32.7h-695.8L1078.6-1645.3z"/><path d="M4002.3-2971.6c-78.8-40.4-334.5-146.1-567.1-232.6c-674.7-253.7-607.4-211.4-1041.8-649.7c-328.7-332.5-486.3-472.9-747.7-670.9l-55.7-42.3h799.6l797.7-1.9l92.3,57.7c382.5,244.1,728.5,826.5,855.4,1439.7c19.2,96.1,30.8,174.9,23.1,174.9C4152.2-2898.5,4081.1-2931.2,4002.3-2971.6z"/></g></g>
            </svg>
          </button>
        </div>
      </div>
      <div id="av1" style="display: inline-block;">
        <img class="avatar-img-sm" id="avatar1" :src="user.avatar" width="35" height="35" alt="" />
      </div>
      <span class="name" id="name1">{{user.username}}</span>

    </div>
    <div class="other-action">
      <div class="switch">
        <button type="button" class="time-sort div-btn" @click="orderByTime()">按时间顺序排序</button>
        <button type="button" class="hot-sort div-btn" @click="orderByHot()">按热度排序</button>
        <button type="button" class="send-sort div-btn" @click="orderBySendMe()">只看写给我的</button>
        <button type="button" class="write-sort div-btn" @click="orderByFromMe()">只看我写的</button>
      </div>
      <button id="set_btn" class="setting div-btn" title="修改个人设置">
        <svg fill="currentColor" style="width: 23px;" version="1.1" x="0px" y="0px" viewBox="0 0 1000 1000" enable-background="new 0 0 1000 1000" xml:space="preserve">
          <g><path d="M940.7,398.3l-93.9-18.8c-4.7-13.6-10.3-26.7-16.4-39.5l53.2-79.7c16.2-24.3,13-56.6-7.7-77.3L817,124.1c-11.8-11.8-27.5-17.9-43.3-17.9c-11.8,0-23.6,3.4-33.9,10.3L660,169.6c-12.8-6.2-25.9-11.7-39.5-16.4l-18.8-93.9C596,30.6,570.8,10,541.7,10h-83.3c-29.2,0-54.4,20.6-60.1,49.2l-18.8,93.9c-13.6,4.7-26.7,10.3-39.5,16.4l-79.7-53.1c-10.4-6.9-22.2-10.3-33.9-10.3c-15.8,0-31.5,6.1-43.4,17.9L124.1,183c-20.7,20.6-23.9,53-7.7,77.3l53.1,79.7c-6.2,12.8-11.7,25.9-16.4,39.5l-93.9,18.8C30.6,404,10,429.2,10,458.3v83.3c0,29.2,20.6,54.3,49.3,60.1l93.9,18.8c4.7,13.6,10.3,26.7,16.4,39.5l-53.1,79.7c-16.2,24.3-13,56.6,7.7,77.3l58.9,58.9c11.9,11.8,27.5,17.9,43.4,17.9c11.8,0,23.6-3.4,33.9-10.3l79.7-53.1c12.8,6.2,25.9,11.7,39.5,16.4l18.8,93.9c5.7,28.6,30.9,49.2,60.1,49.2h83.3c29.2,0,54.3-20.6,60-49.2l18.8-93.9c13.6-4.7,26.7-10.3,39.5-16.4l79.7,53.1c10.4,6.9,22.2,10.3,33.9,10.3c15.8,0,31.5-6.1,43.3-17.9l58.9-58.9c20.6-20.6,23.9-53,7.7-77.3L830.4,660c6.2-12.8,11.7-25.9,16.4-39.5l93.9-18.8c28.7-5.7,49.3-30.9,49.3-60.1v-83.3C990,429.2,969.4,404,940.7,398.3z M834.8,560.4c-21.3,4.2-38.7,19.4-45.8,39.9c-4,11.3-8.5,22.3-13.7,32.9c-9.5,19.5-7.9,42.6,4.1,60.7l53.2,79.7l-58.9,58.9L694,779.5c-10.2-6.8-22.1-10.3-34-10.3c-9.1,0-18.2,2-26.7,6.1c-10.6,5.1-21.6,9.8-32.9,13.7c-20.5,7.1-35.7,24.6-39.9,45.8l-18.8,93.9h-83.3l-18.8-93.9c-4.2-21.3-19.4-38.7-39.9-45.8c-11.3-3.9-22.3-8.5-32.9-13.7c-8.5-4.1-17.6-6.1-26.7-6.1c-11.9,0-23.7,3.5-34,10.3l-79.7,53.1l-58.9-58.9l53.1-79.7c12-18.1,13.6-41.1,4.2-60.6c-5.1-10.6-9.8-21.6-13.7-32.9c-7.1-20.5-24.5-35.7-45.8-39.9l-93.9-18.8l0-83.3l93.9-18.8c21.3-4.3,38.7-19.4,45.8-39.9c3.9-11.3,8.5-22.3,13.7-32.9c9.5-19.5,7.9-42.6-4.1-60.7l-53.1-79.7l58.9-58.9l79.7,53.1c10.2,6.8,22.1,10.3,34,10.3c9.1,0,18.2-2,26.7-6.1c10.6-5.1,21.6-9.8,32.9-13.7c20.5-7.1,35.7-24.6,39.9-45.8l18.8-93.9l83.3,0l18.8,93.9c4.2,21.3,19.4,38.7,39.9,45.8c11.3,3.9,22.3,8.5,32.9,13.7c8.5,4.1,17.6,6.1,26.7,6.1c11.9,0,23.7-3.5,34-10.3l79.7-53.1l58.9,58.9L779.5,306c-12,18.1-13.6,41.1-4.2,60.6c5.1,10.6,9.8,21.6,13.7,32.9c7.1,20.5,24.5,35.7,45.8,39.9l93.9,18.8l0.1,83.3L834.8,560.4z"/><path d="M500,273.9c-125,0-226.2,101.2-226.2,226.1c0,124.9,101.2,226.1,226.2,226.1c124.9,0,226.1-101.2,226.1-226.1C726.1,375.1,624.9,273.9,500,273.9z M500,669.6c-93.7,0-169.6-76-169.6-169.6c0-93.6,75.9-169.6,169.6-169.6c93.6,0,169.6,76,169.6,169.6C669.6,593.6,593.6,669.6,500,669.6z"/>
          </g>
        </svg>
      </button>
      <button id="quit_btn" class="quit div-btn" title="退出账号">
        <svg fill="currentColor" style="width: 23px;" version="1.1" x="0px" y="0px" viewBox="0 0 1000 1000" enable-background="new 0 0 1000 1000" xml:space="preserve">
          <g><path d="M672.9,101.2c169,68.4,288.2,234.1,288.2,427.7C961.2,783.5,754.7,990,500,990C245.3,990,38.8,783.5,38.8,528.8c0-193.5,119.2-359.2,288.2-427.7v128C223.7,289,154.1,400.8,154.1,528.8c0,191,154.9,345.9,345.9,345.9c191,0,345.9-154.9,345.9-345.9c0-128-69.6-239.8-172.9-299.6V101.2z M442.4,10v461.2h115.3V10H442.4z"/></g>
        </svg>
      </button>
      <div id="set_div" class="setting-page" style="display: none;">
        <div class="set-form" id="form2">
          <button class="avatar-set div-btn" title="修改头像" style="margin-top: 26px;">
            <img :src="user.avatar" />
          </button>
          <input type="text" class="username-set easy-input" name="username" :value="user.username" />
          <textarea class="signatrue-set" name="intro" id="sg" :value="user.intro" cols="30" rows="3" maxlength="45"></textarea>
          <div class="desp">&nbsp;&nbsp;你的名字：</div><input type="text" class="easy-input" name="name" :value="user.name" style="margin-top: 5px;margin-bottom: 25px;" />
          <div class="desp">&nbsp;&nbsp;她/他的名字：</div><input type="text" class="easy-input" name="secretLover" :value="user.secretLover" style="margin-top: 5px;margin-bottom: 15px;" />
          <div class="finish">
            <button class="save div-btn" style="margin-right: 17px;">
              <svg style="width: 30px;" fill="currentColor" version="1.1" x="0px" y="0px" viewBox="0 0 1000 1000" enable-background="new 0 0 1000 1000" xml:space="preserve">
                <g><path d="M10,472.3l108.9-110.8L500,749.3L391.1,860.1L10,472.3z M881.1,139.9L990,250.7L500,749.3L391.1,638.5L881.1,139.9z"/></g>
              </svg>
            </button>
            <button class="cancel div-btn">
              <svg fill="currentColor" style="width: 27px;" version="1.1" x="0px" y="0px" viewBox="0 0 1000 1000" enable-background="new 0 0 1000 1000" xml:space="preserve">
                <g><path d="M486.7,203.9L487.9,10L93.6,336l390.1,330.2l1.2-185.2c389.6,52.8,221.3,287-0.7,509C1253.3,488.3,795.8,257.1,486.7,203.9"/></g>
              </svg>
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div id="write_note" style="display: none;">
    <button type="button" class="close" aria-label="Close"><span aria-hidden="true">关闭&times;</span></button>
    <form action="#" id="note_form" class="note-form">
      <input type="text" name="title" class="title-input item easy-input" placeholder="这句话大家不点开就能看见" style="border-bottom: 2px solid #cecece;" />
      <textarea name="content" class="content-input item" rows="8" cols="80" placeholder="这段内容点开了就能看见" style="border: 2px solid #cecece;"></textarea>
      <input type="text" name="writer" class="writer-input item easy-input" placeholder="这句话告诉别人你是谁" style="border-bottom: 2px solid #cecece;" />
      <button type="button" class="next-btn div-btn">
        <svg style="width: 30px;position: relative;left: 3px;top: 2px;" fill="currentColor" version="1.1" x="0px" y="0px" viewBox="0 0 1000 1000" enable-background="new 0 0 1000 1000" xml:space="preserve">
          <g><path d="M760.2,466.1L314.6,20.4c-20.9-13.9-48.7-13.9-69.6,0c-20.9,20.9-20.9,48.7,0,62.7l417.8,417.8L252,911.7c-20.9,20.9-20.9,48.7,0,62.7c20.9,20.9,48.7,20.9,62.7,0l445.6-445.6C774.2,514.8,774.2,486.9,760.2,466.1z"/></g>
        </svg>
      </button>
      <div class="real-recipient" style="display: none;">
        <div style="font-weight: 100;">有确定想写给的人吗？可以在这里写下ta的真名</div>
        <input type="text" name="recipient" class="recipient-input easy-input" />
        <button type="button" class="return-btn div-btn" style="margin-right: 22px;">
          <svg style="width: 30px;" fill="currentColor" version="1.1" x="0px" y="0px" viewBox="0 0 1000 1000" enable-background="new 0 0 1000 1000" xml:space="preserve">
            <g><path d="M328.1,500.8L763.7,82.3c16.6-16.6,16.6-43.4,0-59.9c-16.6-16.6-43.4-16.6-59.9,0L243.9,464.2c-2.7,1.7-5.3,3.7-7.6,6c-16.5,16.6-16.5,43.4,0,59.9l0.3,0.3c0.1,0.1,0.2,0.3,0.3,0.4c0.3,0.3,0.6,0.5,0.9,0.8l465.3,445.9c16.5,16.6,43.4,16.6,59.9,0c16.5-16.6,16.5-43.4,0-59.9L328.1,500.8z"/></g>
          </svg>
        </button>
        <button type="button" class="confirm-btn div-btn" >
          <svg style="width: 30px;" fill="currentColor" version="1.1" x="0px" y="0px" viewBox="0 0 1000 1000" enable-background="new 0 0 1000 1000" xml:space="preserve">
            <g><path d="M974.7,156.5c-20.4-20.4-53.5-20.4-73.8,0L324.5,732.8L99.1,507.4c-20.4-20.4-53.4-20.4-73.8,0c-20.4,20.4-20.4,53.5,0,73.9l262.3,262.3c20.4,20.4,53.4,20.4,73.8,0l613.2-613.2C995.1,209.9,995.1,176.9,974.7,156.5z"/></g>
          </svg>
        </button>
      </div>
    </form>
  </div>
  <ul class="note-list">
    <note-item v-for="note in notes" v-bind:key="note.id" v-bind:note="note"></note-item>
  </ul>

  <div class="pagination center-block">
    <a href="#"><div class="go-home">首页</div></a>
    <ul class="page-list list-unstyled" style="display: inline-block;">
      <li class="current-page"><a href="javascript:;" @click="turnPage(0)">{{search.page[0]}}</a></li>
      <li><a href="javascript:;" @click="turnPage(1)">{{search.page[1]}}</a></li>
      <li><a href="javascript:;" @click="turnPage(2)">{{search.page[2]}}</a></li>
      <li><a href="javascript:;" @click="turnPage(3)">{{search.page[3]}}</a></li>
      <li><a href="javascript:;" @click="turnPage(4)">{{search.page[4]}}</a></li>
    </ul>
    <a href="#"><div class="go-last">尾页</div></a>
  </div>

  <div class="cmpl-black-drop" style="display: none;"></div>
</div>

</body>
<script type="text/javascript" src="/js/jquery.min.js"></script>
<script type="text/javascript" src="/js/vue.js"></script>
<script type="text/javascript" src="/js/vue-router.js"></script>
<script type="text/javascript" src="/js/index.js"></script>
<script type="text/javascript">
  $(function() {
    /* info的显示和隐藏设置 */
    let mflag = false;  // avatar是否显示
    $("#av1").click(function() {
      if(mflag == false) {
        $("#avatar1").animate({
          width: "50px",
          height: "50px",
          border: "2px solid #0000004a"
        }, 255);
        $("#userinf").show();
        $("#name1").hide();
        mflag = true;
      } else {
        $("#avatar1").animate({
          width: "35px",
          height: "35px"
        }, 255);
        $("#userinf").hide();
        $("#name1").show();
        mflag = false;
      }
    });

    /* 点击detail-msg之外的内容，则收起它 */
    $('.cmpl-black-drop').bind("click", function(e) {
      // 假如detail-msg元素可见
      if($('.detail-msg').is(':visible')) {  // 避免影响其他的功能
        $('.detail-msg').fadeOut(800);
        $('.cmpl-black-drop').hide();
      }
    });

    $('.note-list').on('click', '.item', function(e) {
  	  let $target = $(e.currentTarget);
  	  let $mainMsg = $target.children('.main-msg');
  	  
  	  if($mainMsg.is(':hidden')) { // 假如主要内容不可见
  	    $target.children('.back-msg').hide();
  	    $target.children('.note-action').hide();
  	    
  	    $mainMsg.fadeIn(700);
  	    $target.children('.goback').show(); // 记得显示返回图标
  	  } else {  // 如果已经显示了，再点击就显示详细信息
  	    $(".cmpl-black-drop").show();
  	    $target.children(".detail-msg").fadeIn();
  	  }
    });
    
    /* 点击note上的返回图标事件 */
    $('.note-list').on('click','.goback' , function(e) {
      e.stopPropagation();  // 阻止事件冒泡
      let $target = $(e.currentTarget);
      let $parent = $target.parent('.item');

      $parent.children('.main-msg').hide();
      $target.hide();

      $parent.children('.back-msg').fadeIn();
      $parent.children('.note-action').fadeIn();
    });

    //falg
    testt();
    
    $('.note-list').on('click','.interest' , function(e) {
      e.stopPropagation();  // 阻止事件冒泡
      
      let id = $(e.currentTarget).parent().attr("value");
      let targetPic = $(e.currentTarget).children('.interest-pic');
      let is_cared = targetPic.hasClass('interested');
      
      let likeTarget = $(e.currentTarget).prev();	// 获取点赞对象
      let likeTargetPic = likeTarget.children('.like-pic');	// 获取点赞的图片对象
      
      // 获取当前点击的note在vue的数据中的id
      let vue_id = $app.$data.notes[0].id - parseInt(id);

      // 如果isCared为真，说明用户已经关注过了，再次点击就是取消，应从数据库中取消当前用户的关注
      // 如果isCared为假，说明用户即将要进行关注，再次点击就是添加关注，应从数据库中添加该用户对id为当前id的note的点赞和关注
      $.post("/note/careNote", {id: id, isCared: is_cared}, (data)=>{
    	  if(true == is_cared) {
    		$app.$data.notes[vue_id].interest--;
			targetPic.removeClass('interested');
    	  } else {
    		$app.$data.notes[vue_id].interest++;
			targetPic.addClass('interested');
			
			if(likeTargetPic.hasClass('liked') == false) { 	// 如果在关注的同时发现没有点赞的话，就进行点赞操作
			  $app.$data.notes[vue_id].like++;
			  likeTargetPic.addClass('liked');
			}
    	  }
      });

    });

    // 保存个人设置
    // TODO: 添加更新数据到数据库的方法
    $('.finish .save').bind('click', function(event) {
      alert("更新成功");
    });

    // 取消更新个人设置
    $('.finish .cancel').bind('click', function(event) {
      $('#set_div').hide();
    });

    // 单击设置按钮的事件
    $('#set_btn').bind('click', function(event) {
      $('#set_div').show();
    });

    // 点击写留言按钮
    $('#userinf .note-write').bind('click', function(event) {
      $('.cmpl-black-drop').show();
      $('#write_note').show();
    });

    // 单击写note时的close按钮
    $('#write_note .close').bind('click', function(event) {
      $('.cmpl-black-drop').hide();
      $('#write_note').hide();
    });

    // 在写note时点击下一步按钮
    $('#note_form .next-btn').bind('click', function(event) {

      // 标题和内容不能为空
     // if($('#note_form .title-input').val() == "" || $('#note_form .content-input').val() == "") {
     //   alert("抱歉，标题和内容您需要写点东西上去");
     // } else {
        $('#note_form .item').hide();
        $('#note_form .next-btn').hide();

        $('#note_form .real-recipient').show();
      // }
    });

    // 点击写note表单的返回按钮
    $('#note_form .return-btn').bind('click', function(event) {
      $('#note_form .item').show();
      $('#note_form .next-btn').show();

      $('#note_form .real-recipient').hide();
    });

    // 提交写note的表单
    $('#note_form .confirm-btn').bind('click', function(event) {
      alert("提交成功");
    });
    
  });
  
  // TODO: 要添加一个在页面一加载就执行的方法，从数据库中查找当前用户对当前页面的所有note的点赞和关心记录，
  // 并在回调函数中对这些note进行添加liked和interest类
  function addLikeAndInterest() {
	  let noteIdList = [];
	  
	  let rawList = $app.$data.notes;
	  /* 按顺序把当前页面note的id放入list中  */
	  for(let i=0; i<rawList.length; ++i) {
		  noteIdList.push(rawList[i].id);
	  }
	  
	  $.ajax({
		  url: "/note/returnUserLikeAndInterest",
		  type: "POST",
		  data: {
			  "idList": noteIdList
		  },
		  dataType:"json",	// 这条必须加
		  traditional: true,
		  success: function(data) {
			  for(let i=0; i<data.length; ++i) {
				  let $li = $('.note-list li').eq(i);
				  if(data[i].liked == true) {
					  $li.find('.like-pic').addClass('liked');
				  } else {
					  $li.find('.like-pic').removeClass('liked');
				  }
				  
				  if(data[i].cared == true) {
					  $li.find('.interest-pic').addClass('interested');
				  } else {
					  $li.find('.interest-pic').removeClass('interested');
				  }
			  }
		  }
	  });
  }
  
  function testt() {
	  $('.note-list').on('click','.like' ,function(e) {
	      e.stopPropagation();  // 阻止事件冒泡
	      
	      let id = $(e.currentTarget).parent().attr("value");
	      let targetPic = $(e.currentTarget).children('.like-pic');
	      let is_liked = targetPic.hasClass('liked');
	      
	      // 获取当前点击的note在vue的数据中的id
	      let vue_id = $app.$data.notes[0].id - parseInt(id);
	      
	      // 当用户对当前note点击了interest按钮后，必须取消interest才能进行点赞操作
	      let $interestPic = $(e.currentTarget).next().children('.interest-pic');
	      if(is_liked == true && $interestPic.hasClass('interested')) {
	    	  alert("抱歉，您需要先取消关注才能取消对当前便条的点赞");
	    	  return;
	      }
	      
	      $.post("/note/likeNote", {id: id, isLiked: is_liked}, (data)=>{
	    	  if(true == is_liked) {	// 如果用户点赞过了，就取消点赞
	    		  // 修改vue中的数据
	    		  $app.$data.notes[vue_id].like--;
	    		  targetPic.removeClass('liked');
	    	  } else {
	    		  
	    		  $app.$data.notes[vue_id].like++;
	    		  targetPic.addClass('liked');
	    	  }
	      });
	      
	    });
  }
</script>
</html>
